# 19-2. 필터의 구현
필터를 구현하는 데 있어 핵심은 다음의 3개 타입이다.
- javax.servlet.Filter 인터페이스: 클라이언트와 최종 자원 사이에 위치하는 필터를 나타내는 객체가 구현해야 하는 인터페이스이다.
- javax.servlet.ServletRequestWrapper 클래스: 필터가 요청을 변경한 결과를 저장하는 래퍼이다.
- javax.servlet.ServletResponseWrapper 클래스: 필터가 응답을 변경하기 위해 사용하는 래퍼이다.

개발자는 이 세 타입을 이용해서 필터를 구현하고 요청과 응답 정보를 변경하는 기능을 구현할 수 있다.
***
## Filter 인터페이스
Filter 인터페이스는 다음과 같은 메서드를 선언하고 있으며, 필터 기능을 제공할 클래스는 Filter 인터페이스를 알맞게 구현해주어야 한다.
- public void init(FilterConfig filterConfig) throws ServletException: 필터를 초기화할 때 호출된다.
- public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws java.io.lOException, ServletException:
필터 기능을 수행한다. chain을 이용해서 체인의 다음 필터로 처리를 전달할 수 있다.
- public void destroy(): 필터가 웹 컨테이너에서 삭제될 때 호출된다.

위의 메서드에서 필터의 역할을 하는 메서드가 바로 doFilter() 메서드이다. 
서블릿 컨테이너는 사용자가 특정한 자원을 요청했을 때 그 자원 사이에 필터가 존재하는 경우 필터 객체의 doFilter() 메서드를 호출한다.
```java
public class FirstFilter implements Filter {

  public void init(FilterConfig filterConfig) throws ServletException {
    //필터 초기화 작업
  }

  public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws java.io.lOException, ServletException {
    //1. request 파라미터를 이용하여 요청의 필터 작업 수행

    //2. 체인의 다음 필터 처리
    chain.doFilter(request, response);

    //3. response를 이용하여 응답의 필터링 작업 수행
  }

  public void destroy() {
    //주로 필터가 사용한 자원을 반납
  }
}
```
Filter 인터페이스의 doFilter() 메서드는 요청이 있을 때마다 매번 실행된다.
doFilter() 메서드에서 전달받는 FilterChain 객체는 클라이언트가 요청한 자원에 이르기까지 클라이언트의 요청이 거쳐 가게 되는 필터 체인을 의미한다.

위 코드에의하면 요청을 필터링 한 필터 객체(FirstFilter)가 또다시 응답을 필터링한다.
1단계와 3단계 사이에서 다음 필터로 이동하기 때문에 요청의 필터 적용 순서와 응답의 필터 적용 순서는 반대가 된다.

init() 메서드에 전달되는 FilterConfig는 필터의 초기화 파라미터를 읽어올 때 사용하며 제공하는 메서드는 다음과 같다.

![image](https://github.com/GYUNGAEEEE/JSP/assets/158580466/b11fad53-3ec9-4c18-baa9-0d93e2f73985)
